<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Jazz Chords</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="app">
    <!-- Accord d√©tect√© + Notes -->
    <div class="main-display">
      <!-- Ligne 1 : Tous les boutons -->
      <div class="control-buttons-row">
        <span class="app-description">Construisez vos accords ou r√©visez</span>
        <button id="playChordBtn" class="icon-btn" title="√âcouter l'accord" style="display: none;">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
            <polygon points="5 3 19 12 5 21 5 3"></polygon>
          </svg>
        </button>
        <button id="resetNotes" class="icon-btn reset-btn" title="R√©initialiser">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
            <path d="M21 3v5h-5"></path>
            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
            <path d="M3 21v-5h5"></path>
          </svg>
        </button>
        <button id="micToggle" class="icon-btn" title="Activer le micro">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path>
            <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
            <line x1="12" x2="12" y1="19" y2="22"></line>
          </svg>
        </button>
        <button id="helpBtn" class="icon-btn help-btn-fixed" title="Mode d'emploi">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
            <circle cx="12" cy="17" r="0.5" fill="currentColor"></circle>
          </svg>
        </button>
      </div>

      <!-- Ligne 2 : Accord avec port√©e √† droite -->
      <div class="chord-info-line">
        <div class="chord-display-row">
          <div class="chord-left-section">
            <div class="chord-name-section">
              <h2 id="chordName">-</h2>
            </div>
            <div class="chord-notes-row">
              <div class="notes-container-with-btn">
                <div id="chordNotesList" class="notes-list-inline">
                  <div class="empty-state">-</div>
                </div>
                <button id="toggleChordVisibility" class="toggle-visibility-btn" title="Masquer/Afficher">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg>
                </button>
              </div>
            </div>
          </div>
          <div class="staff-container" id="staffContainer">
            <svg id="musicalStaff" width="105" height="90" viewBox="0 0 105 90">
              <!-- La port√©e sera g√©n√©r√©e dynamiquement -->
            </svg>
          </div>
        </div>
      </div>
    </div>

    <!-- Clavier virtuel avec notes jou√©es -->
    <div class="keyboard-panel">
      <div class="keyboard-container">
        <div id="keyboard" class="keyboard"></div>
      </div>
      
      <div class="played-notes-in-keyboard">
        <div class="notes-played-label">
          <span>Notes</span>
          <span>jou√©es</span>
        </div>
        <div class="played-notes-wrapper">
          <div id="playedNotes" class="notes-list-inline">
            <div class="empty-state">Aucune</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Zone de saisie manuelle - 5 lignes -->
    <div class="input-panel">
      <!-- Ligne 1: Notes A-G + espace + # et b -->
      <div class="input-row">
        <div id="rootNotes" class="btn-group"></div>
        <div class="row-spacer"></div>
        <div id="alterations" class="btn-group"></div>
      </div>
      
      <!-- Ligne 2: Mineur, Augment√©, Sus2, Sus4 (mutuellement exclusifs) -->
      <div class="input-row">
        <div id="baseQualities" class="btn-group"></div>
      </div>
      
      <!-- Ligne 3: Qualit√©s de base (7, M7, etc.) -->
      <div class="input-row">
        <div id="qualities" class="btn-group-with-links"></div>
      </div>
      
      <!-- Ligne 4: Extensions (incluant 6/9 et add9) -->
      <div class="input-row">
        <div id="simpleExtensions" class="btn-group"></div>
      </div>
      
      <!-- Ligne 5: Alt√©rations (#5, b5, b9, #9, #11, b13, alt) -->
      <div class="input-row">
        <div id="alteredExtensions" class="btn-group"></div>
      </div>
    </div>

    <!-- Zone al√©atoire -->
    <div class="random-panel">
      <span class="generate-label">Quiz : accord de</span>
      <div class="note-count-grid">
        <button class="note-count-btn" data-count="3">3</button>
        <button class="note-count-btn" data-count="4">4</button>
        <button class="note-count-btn" data-count="5">5</button>
        <button class="note-count-btn" data-count="6">6</button>
      </div>
      <span class="notes-label">notes</span>
    </div>
  </div>

  <!-- Modale d'aide -->
  <div id="helpModal" class="modal">
    <div class="modal-content">
      <button id="closeHelp" class="close-modal">‚úï</button>
      <h3>Apprenez les accords de jazz</h3>
      
      <div class="help-section">
        <h4>üéπ Saisie manuelle</h4>
        <p>Construisez votre accord en cliquant au moins sur le bouton d'une note fondamentale :</p>
        <ul>
          <li><strong>Ligne 1 :</strong> Note fondamentale (A-G) + alt√©ration (‚ôØ/‚ô≠) + mineur (-/min)</li>
          <li><strong>Ligne 2 :</strong> Qualit√© (7, M7, m7b5 ...)</li>
          <li><strong>Ligne 3 :</strong> Extensions (6, 9, 11...)</li>
          <li><strong>Ligne 4 :</strong> Alt√©rations (‚ô≠5, ‚ôØ5, ‚ô≠9, ‚ôØ9...)</li>
        </ul>
        <p>Accord inexistant = boutons rouges.</p>
      </div>
      
      <div class="help-section">
        <h4>üéÆ Quiz</h4>
        <p>Cliquez sur le nombre de notes (3, 4, 5 ou 6) pour g√©n√©rer un accord al√©atoire. Trouvez les bonnes notes sur le clavier !</p>
        <p>Le bouton ≈ìil 
          <span style="display: inline-flex; align-items: center; background: #f97316; padding: 4px 6px; border-radius: 4px; margin: 0 4px;">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
              <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
              <line x1="1" y1="1" x2="23" y2="23"></line>
            </svg>
          </span> 
          permet de masquer/afficher les notes de l'accord.</p>
      </div>
      
      <div class="help-section">
        <h4>üéº Clavier virtuel</h4>
        <p>Cliquez sur les touches pour jouer les notes. Les notes jou√©es apparaissent en <strong style="color: #22c55e;">vert</strong> si elles font partie de l'accord, en <strong style="color: #ef4444;">rouge</strong> sinon. Le pouce üëç s'affiche quand toutes les bonnes notes sont trouv√©es.</p>
        <p>Si vous jouez des notes librement sur le clavier et qu'elles correspondent √† un accord connu, celui-ci s'affichera automatiquement dans la zone d'affichage en haut.</p>
      </div>
      
      <div class="help-section">
        <h4>‚öôÔ∏è Boutons</h4>
        <ul>
          <li><strong>‚ñ∂ :</strong> √âcouter l'accord</li>
          <li><strong><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2" style="vertical-align: middle; display: inline-block;">
            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
            <path d="M21 3v5h-5"></path>
            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
            <path d="M3 21v-5h5"></path>
          </svg> :</strong> R√©initialiser</li>
          <li><strong><svg width="14" height="14" viewBox="0 0 32 24" fill="none" stroke="currentColor" stroke-width="2.5" style="vertical-align: middle; display: inline-block;">
      <path d="M16 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path>
      <path d="M23 10v2a7 7 0 0 1-14 0v-2"></path>
      <line x1="16" x2="16" y1="19" y2="22"></line>
      <path d="M24 7c1.5 1.5 2 3.5 2 5s-0.5 3.5-2 5" stroke-width="4" opacity="0.9"></path>
      <path d="M7 7c-1.5 1.5-2 3.5-2 5s0.5 3.5 2 5" stroke-width="4" opacity="0.9"></path>
      <path d="M28 4c2 2 3 5 3 8s-1 6-3 8" stroke-width="3.5" opacity="0.7"></path>
      <path d="M3 4c-2 2-3 5-3 8s1 6 3 8" stroke-width="3.5" opacity="0.7"></path>
    </svg> :</strong> D√©tecter les notes via micro</li>
        </ul>
      </div>
    </div>
  </div>

  <script src="chords.js"></script>
  <script src="keyboard.js"></script>
  <script src="detector.js"></script>
  <script src="audio-manager.js"></script>
  <script src="staff.js"></script>
  <script src="ui.js"></script>
  <script src="app.js"></script>
</body>
</html>