<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light only">
  <meta name="theme-color" content="#0a0e1a">
  <title>Jazz Chords</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
</head>
<body>
  <div id="app">
    <!-- Accord d√©tect√© + Notes -->
    <div class="main-display">
      <!-- Ligne 1 : Tous les boutons -->
      <div class="control-buttons-row">
        <span class="app-description">Construisez vos accords ou r√©visez</span>
        <button id="playChordBtn" class="icon-btn" title="√âcouter l'accord" style="display: none;">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
            <polygon points="5 3 19 12 5 21 5 3"></polygon>
          </svg>
        </button>
        <button id="resetNotes" class="icon-btn reset-btn" title="R√©initialiser">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
            <path d="M21 3v5h-5"></path>
            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
            <path d="M3 21v-5h5"></path>
          </svg>
        </button>
        <button id="micToggle" class="icon-btn" title="Activer le micro">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path>
            <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
            <line x1="12" x2="12" y1="19" y2="22"></line>
          </svg>
        </button>
        <button id="helpBtn" class="icon-btn help-btn-fixed" title="Mode d'emploi">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
            <circle cx="12" cy="17" r="0.5" fill="currentColor"></circle>
          </svg>
        </button>
      </div>

      <!-- Ligne 2 : Accord avec port√©e √† droite -->
      <div class="chord-info-line">
        <div class="chord-display-row">
          <div class="chord-left-section">
            <div class="chord-name-section">
              <h2 id="chordName">-</h2>
              <div id="chordNotesList" class="chord-notes-vertical">
                <div class="empty-state">-</div>
              </div>
            </div>
            <div class="chord-notes-row">
              <div id="chordNotesMessage" class="chord-notes-message"></div>
              <div class="notes-container-with-btn">
                <button id="toggleChordVisibility" class="toggle-visibility-btn" title="Masquer/Afficher">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg>
                </button>
              </div>
            </div>
          </div>
          <div class="staff-container" id="staffContainer">
            <svg id="musicalStaff" width="130" height="125" viewBox="0 0 130 125">
              <!-- La port√©e sera g√©n√©r√©e dynamiquement -->
            </svg>
          </div>
        </div>
      </div>
    </div>

    <!-- Clavier virtuel avec notes jou√©es -->
    <div class="keyboard-panel">
      <div class="keyboard-container">
        <div id="keyboard" class="keyboard"></div>
      </div>
      
      <div class="played-notes-in-keyboard">
        <div class="notes-played-label">
          <span>Notes</span>
          <span>jou√©es :</span>
        </div>
        <div class="played-notes-wrapper">
          <div id="playedNotes" class="notes-list-inline">
            <div class="empty-state">Aucune</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Zone de saisie manuelle - 5 lignes -->
    <div class="input-panel">
      <!-- Ligne 1: Notes A-G + espace + # et b -->
      <div class="input-row">
        <div id="rootNotes" class="btn-group"></div>
        <div class="row-spacer"></div>
        <div id="alterations" class="btn-group"></div>
      </div>
      
      <!-- Ligne 2: Mineur, Augment√©, Sus2, Sus4 (mutuellement exclusifs) -->
      <div class="input-row">
        <div id="baseQualities" class="btn-group"></div>
      </div>
      
      <!-- Ligne 3: Qualit√©s de base (7, M7, etc.) -->
      <div class="input-row">
        <div id="qualities" class="btn-group-with-links"></div>
      </div>
      
      <!-- Ligne 4: Extensions (incluant 6/9 et add9) -->
      <div class="input-row">
        <div id="simpleExtensions" class="btn-group"></div>
      </div>
      
      <!-- Ligne 5: Alt√©rations (#5, b5, b9, #9, #11, b13, alt) -->
      <div class="input-row">
        <div id="alteredExtensions" class="btn-group"></div>
      </div>
    </div>

    <!-- Zone al√©atoire -->
    <div class="random-panel">
      <span class="generate-label">Quiz : accord de</span>
      <div class="note-count-grid">
        <button class="note-count-btn" data-count="3">3</button>
        <button class="note-count-btn" data-count="4">4</button>
        <button class="note-count-btn" data-count="5">5</button>
        <button class="note-count-btn" data-count="6">6</button>
      </div>
      <span class="notes-label">notes</span>
    </div>
  </div>

  <!-- Modale d'aide -->
  <div id="helpModal" class="modal">
    <div class="modal-content">
      <button id="closeHelp" class="close-modal">‚úï</button>
      <h3>Mode d'emploi - Jazz Chords</h3>
      
      <div class="help-section">
        <h4>‚úã Saisie manuelle</h4>
        <p>
          <strong>Ligne 1 :</strong> Fondamentale (A-G) + alt√©ration (‚ôØ/‚ô≠)<br>
          <strong>Ligne 2 :</strong> Qualit√©s (m, dim, aug, sus)<br>
          <strong>Ligne 3 :</strong> Septi√®mes (7, M7, m7...)<br>
          <strong>Ligne 4 :</strong> Extensions (9, 11, 13...)<br>
          <strong>Ligne 5 :</strong> Alt√©rations (‚ô≠5, ‚ôØ9...)<br>
          Boutons rouges = accord inexistant.
        </p>
      </div>
      
      <div class="help-section">
        <h4>üéÆ Quiz</h4>
        <p>Cliquez sur 3, 4, 5 ou 6 notes pour g√©n√©rer un accord al√©atoire. Trouvez les bonnes notes sur le clavier ! Bouton ≈ìil 
          <span style="display: inline-flex; align-items: center; background: #f97316; padding: 2px 4px; border-radius: 3px; margin: 0 2px;">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
              <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
              <line x1="1" y1="1" x2="23" y2="23"></line>
            </svg>
          </span> = masquer/afficher les notes.</p>
      </div>
      
      <div class="help-section">
        <h4>üéπ Clavier virtuel</h4>
        <p>Cliquez pour jouer. Notes <strong style="color: #22c55e;">vertes</strong> = correctes, <strong style="color: #ef4444;">rouges</strong> = incorrectes. üëç = toutes trouv√©es. Jouer librement d√©tecte automatiquement l'accord.</p>
      </div>
      
      <div class="help-section">
        <h4><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.5" style="vertical-align: middle; display: inline-block; margin-right: 4px;">
          <line x1="2" y1="8" x2="22" y2="8"></line>
          <line x1="2" y1="12" x2="22" y2="12"></line>
          <line x1="2" y1="16" x2="22" y2="16"></line>
          <circle cx="6" cy="12" r="2" fill="white"></circle>
          <circle cx="12" cy="10" r="2" fill="white"></circle>
          <circle cx="18" cy="14" r="2" fill="white"></circle>
        </svg> Port√©e musicale</h4>
        <p>Notes affich√©es en notation classique avec cl√© de sol. Liste verticale = notes de haut en bas comme sur la port√©e.</p>
      </div>
      
      <div class="help-section">
        <h4>‚öôÔ∏è Boutons</h4>
        <p><strong>‚ñ∂</strong> √âcouter ¬∑ <strong>‚Üª</strong> R√©initialiser ¬∑ <strong>üé§</strong> D√©tecter via micro</p>
      </div>
    </div>
  </div>

  <script src="chords.js?v=2.8"></script>
  <script src="keyboard.js?v=2.8"></script>
  <script src="detector.js?v=2.8"></script>
  <script src="audio-manager.js?v=2.8"></script>
  <script src="staff.js?v=2.8"></script>
  <script src="ui.js?v=2.8"></script>
  <script src="app.js?v=2.8"></script>
</body>
</html>